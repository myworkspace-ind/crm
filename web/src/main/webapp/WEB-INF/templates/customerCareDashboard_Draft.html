<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<!-- COMMON META AND TITLE -->
    <th:block th:include="fragments/common_meta_title"></th:block>

    <!-- HEAD FRAGMENT -->
    <th:block th:include="fragments/head"></th:block>

    <!-- COMMON CSS -->
    <th:block th:include="fragments/common_css"></th:block>
    
    <!-- START COMMON JAVASCRIPT -->
	<th:block th:include="fragments/common_javascript"></th:block>
	
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	
	<style>
        .card {
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .kpi-card {
            text-align: center;
            padding: 15px;
        }
        .kpi-value {
            font-size: 24px;
            font-weight: bold;
        }
        .kpi-label {
            font-size: 14px;
            color: #6c757d;
        }
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
    </style>
    
</head>
<body>
	<!-- BEGIN HEADER  -->
	<th:block th:include="fragments/hmenu"></th:block>
	<!-- END HEADER  -->
	
	<div class="container-fluid mt-4" id="dashboard-content">
	    <div class="row mb-4">
	        <div class="col-md-3">
	            <div class="card kpi-card">
	                <div class="kpi-value" id="totalCustomers">0</div>
	                <div class="kpi-label">Tổng KH cần chăm sóc</div>
	            </div>
	        </div>
	        <div class="col-md-3">
	            <div class="card kpi-card">
	                <div class="kpi-value" id="notCaredCount">0</div>
	                <div class="kpi-label">KH chưa chăm sóc</div>
	            </div>
	        </div>
	        <div class="col-md-3">
	            <div class="card kpi-card">
	                <div class="kpi-value" id="caredOnTimeCount">0</div>
	                <div class="kpi-label">KH chăm sóc đúng hạn</div>
	            </div>
	        </div>
	        <div class="col-md-3">
	            <div class="card kpi-card">
	                <div class="kpi-value" id="caredLateCount">0</div>
	                <div class="kpi-label">KH chăm sóc trễ hạn</div>
	            </div>
	        </div>
	    </div>

    	<!-- Biểu đồ -->
	    <div class="row">
	        <div class="col-md-6">
	            <div class="card">
	                <div class="card-header">Phân bổ KH theo trạng thái chính</div>
	                <div class="card-body">
	                    <div class="chart-container">
	                        <canvas id="statusChart"></canvas>
	                    </div>
	                </div>
	            </div>
	        </div>
	        <div class="col-md-6">
	            <div class="card">
	                <div class="card-header">Tỷ lệ hoàn thành chăm sóc</div>
	                <div class="card-body">
	                    <div class="chart-container">
	                        <canvas id="completionChart"></canvas>
	                    </div>
	                </div>
	            </div>
	        </div>
	    </div>

	    <div class="row mt-4">
	        <div class="col-md-6">
	            <div class="card">
	                <div class="card-header">Tỷ lệ chăm sóc đúng hạn</div>
	                <div class="card-body">
	                    <div class="chart-container">
	                        <canvas id="timelinessChart"></canvas>
	                    </div>
	                </div>
	            </div>
	        </div>
	        <div class="col-md-6">
	            <div class="card">
	                <div class="card-header">Xu hướng chăm sóc theo thời gian</div>
	                <div class="card-body">
	                    <div class="chart-container">
	                        <canvas id="trendChart"></canvas>
	                    </div>
	                </div>
	            </div>
	        </div>
	    </div>
	
	    <div class="row mt-4">
	        <div class="col-md-6">
	            <div class="card">
	                <div class="card-header">Top nhân viên chăm sóc hiệu quả</div>
	                <div class="card-body">
	                    <div class="chart-container">
	                        <canvas id="employeeChart"></canvas>
	                    </div>
	                </div>
	            </div>
	        </div>
	        <div class="col-md-6">
	            <div class="card">
	                <div class="card-header">Phân bổ KH theo độ ưu tiên</div>
	                <div class="card-body">
	                    <div class="chart-container">
	                        <canvas id="priorityChart"></canvas>
	                    </div>
	                </div>
	            </div>
	        </div>
	    </div>
</div>

	<script>
	    document.addEventListener('DOMContentLoaded', function () {
	        // Dữ liệu giả lập
	        const stats = {
	            totalCustomers: 120,
	            notCaredCount: 35,
	            caredOnTimeCount: 60,
	            caredLateCount: 25,
	            statusDistribution: {
	                "Mới": 30,
	                "Đang chăm sóc": 50,
	                "Hoàn tất": 40
	            },
	            priorityDistribution: {
	                "Cao": 40,
	                "Trung bình": 50,
	                "Thấp": 30
	            },
	            careTrend: [
	                { date: "2025-06-01", count: 10 },
	                { date: "2025-06-02", count: 15 },
	                { date: "2025-06-03", count: 12 },
	                { date: "2025-06-04", count: 20 },
	                { date: "2025-06-05", count: 18 }
	            ],
	            topPerformers: [
	                { employeeName: "Nguyễn Văn A", customerCount: 25 },
	                { employeeName: "Trần Thị B", customerCount: 20 },
	                { employeeName: "Lê Văn C", customerCount: 18 }
	            ]
	        };
	
	        // Cập nhật KPI
	        document.getElementById("totalCustomers").textContent = stats.totalCustomers;
	        document.getElementById("notCaredCount").textContent = stats.notCaredCount;
	        document.getElementById("caredOnTimeCount").textContent = stats.caredOnTimeCount;
	        document.getElementById("caredLateCount").textContent = stats.caredLateCount;
	
	        // Trạng thái khách hàng
	        new Chart(document.getElementById('statusChart'), {
	            type: 'pie',
	            data: {
	                labels: Object.keys(stats.statusDistribution),
	                datasets: [{
	                    data: Object.values(stats.statusDistribution),
	                    backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56']
	                }]
	            }
	        });
	
	        // Tỷ lệ hoàn thành chăm sóc
	        new Chart(document.getElementById('completionChart'), {
	            type: 'doughnut',
	            data: {
	                labels: ['Đã chăm sóc', 'Chưa chăm sóc'],
	                datasets: [{
	                    data: [
	                        stats.totalCustomers - stats.notCaredCount,
	                        stats.notCaredCount
	                    ],
	                    backgroundColor: ['#36A2EB', '#FF6384']
	                }]
	            }
	        });
	
	        // Tỷ lệ đúng hạn / trễ hạn
	        new Chart(document.getElementById('timelinessChart'), {
	            type: 'bar',
	            data: {
	                labels: ['Đúng hạn', 'Trễ hạn'],
	                datasets: [{
	                    label: 'Số lượng KH',
	                    data: [stats.caredOnTimeCount, stats.caredLateCount],
	                    backgroundColor: ['#4BC0C0', '#FF6384']
	                }]
	            }
	        });
	
	        // Xu hướng chăm sóc theo thời gian
	        new Chart(document.getElementById('trendChart'), {
	            type: 'line',
	            data: {
	                labels: stats.careTrend.map(entry => entry.date),
	                datasets: [{
	                    label: 'Số KH chăm sóc',
	                    data: stats.careTrend.map(entry => entry.count),
	                    borderColor: '#36A2EB',
	                    fill: false
	                }]
	            },
	            options: {
	                scales: {
	                    x: { title: { display: true, text: 'Ngày' } },
	                    y: { title: { display: true, text: 'Số lượng' } }
	                }
	            }
	        });
	
	        // Top nhân viên
	        new Chart(document.getElementById('employeeChart'), {
	            type: 'bar',
	            data: {
	                labels: stats.topPerformers.map(emp => emp.employeeName),
	                datasets: [{
	                    label: 'Số KH chăm sóc',
	                    data: stats.topPerformers.map(emp => emp.customerCount),
	                    backgroundColor: '#FFCE56'
	                }]
	            },
	            options: {
	                indexAxis: 'y',
	                scales: {
	                    x: { beginAtZero: true }
	                }
	            }
	        });
	
	        // Phân bổ độ ưu tiên
	        new Chart(document.getElementById('priorityChart'), {
	            type: 'pie',
	            data: {
	                labels: Object.keys(stats.priorityDistribution),
	                datasets: [{
	                    data: Object.values(stats.priorityDistribution),
	                    backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56']
	                }]
	            }
	        });
	    });
	</script>
<!-- 	<div class="container-fluid mt-4" id="dashboard-content"> -->
<!--         <div class="row mb-4"> -->
<!--             <div class="col-md-3"> -->
<!--                 <div class="card kpi-card"> -->
<!--                     <div class="kpi-value" th:text="${stats.totalCustomers}">0</div> -->
<!--                     <div class="kpi-label">Tổng KH cần chăm sóc</div> -->
<!--                 </div> -->
<!--             </div> -->
<!--             <div class="col-md-3"> -->
<!--                 <div class="card kpi-card"> -->
<!--                     <div class="kpi-value" th:text="${stats.notCaredCount}">0</div> -->
<!--                     <div class="kpi-label">KH chưa chăm sóc</div> -->
<!--                 </div> -->
<!--             </div> -->
<!--             <div class="col-md-3"> -->
<!--                 <div class="card kpi-card"> -->
<!--                     <div class="kpi-value" th:text="${stats.caredOnTimeCount}">0</div> -->
<!--                     <div class="kpi-label">KH chăm sóc đúng hạn</div> -->
<!--                 </div> -->
<!--             </div> -->
<!--             <div class="col-md-3"> -->
<!--                 <div class="card kpi-card"> -->
<!--                     <div class="kpi-value" th:text="${stats.caredLateCount}">0</div> -->
<!--                     <div class="kpi-label">KH chăm sóc trễ hạn</div> -->
<!--                 </div> -->
<!--             </div> -->
<!--         </div> -->

<!--         <div class="row"> -->
<!--             <div class="col-md-6"> -->
<!--                 <div class="card"> -->
<!--                     <div class="card-header">Phân bổ KH theo trạng thái chính</div> -->
<!--                     <div class="card-body"> -->
<!--                         <div class="chart-container"> -->
<!--                             <canvas id="statusChart"></canvas> -->
<!--                         </div> -->
<!--                     </div> -->
<!--                 </div> -->
<!--             </div> -->
<!--             <div class="col-md-6"> -->
<!--                 <div class="card"> -->
<!--                     <div class="card-header">Tỷ lệ hoàn thành chăm sóc</div> -->
<!--                     <div class="card-body"> -->
<!--                         <div class="chart-container"> -->
<!--                             <canvas id="completionChart"></canvas> -->
<!--                         </div> -->
<!--                     </div> -->
<!--                 </div> -->
<!--             </div> -->
<!--         </div> -->

<!--         <div class="row mt-4"> -->
<!--             <div class="col-md-6"> -->
<!--                 <div class="card"> -->
<!--                     <div class="card-header">Tỷ lệ chăm sóc đúng hạn</div> -->
<!--                     <div class="card-body"> -->
<!--                         <div class="chart-container"> -->
<!--                             <canvas id="timelinessChart"></canvas> -->
<!--                         </div> -->
<!--                     </div> -->
<!--                 </div> -->
<!--             </div> -->
<!--             <div class="col-md-6"> -->
<!--                 <div class="card"> -->
<!--                     <div class="card-header">Xu hướng chăm sóc theo thời gian</div> -->
<!--                     <div class="card-body"> -->
<!--                         <div class="chart-container"> -->
<!--                             <canvas id="trendChart"></canvas> -->
<!--                         </div> -->
<!--                     </div> -->
<!--                 </div> -->
<!--             </div> -->
<!--         </div> -->

<!--         <div class="row mt-4"> -->
<!--             <div class="col-md-6"> -->
<!--                 <div class="card"> -->
<!--                     <div class="card-header">Top nhân viên chăm sóc hiệu quả</div> -->
<!--                     <div class="card-body"> -->
<!--                         <div class="chart-container"> -->
<!--                             <canvas id="employeeChart"></canvas> -->
<!--                         </div> -->
<!--                     </div> -->
<!--                 </div> -->
<!--             </div> -->
<!--             <div class="col-md-6"> -->
<!--                 <div class="card"> -->
<!--                     <div class="card-header">Phân bổ KH theo độ ưu tiên</div> -->
<!--                     <div class="card-body"> -->
<!--                         <div class="chart-container"> -->
<!--                             <canvas id="priorityChart"></canvas> -->
<!--                         </div> -->
<!--                     </div> -->
<!--                 </div> -->
<!--             </div> -->
<!--         </div> -->
<!--     </div> -->


	
</body>
</html>